<!DOCTYPE html>
<html class="no-js" lang="zh-cn">
  <head>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script>
    <link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet" />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="twitter:card" content="summary" />
    <meta property="og:title" content="Profiling.Profiler-GetTotalFragmentationInfo - Unity 脚本 API" />
    <title>Profiling.Profiler-GetTotalFragmentationInfo - Unity 脚本 API</title>
    <meta name="description" content="Returns heap memory fragmentation information." />
    <meta property="og:description" content="Returns heap memory fragmentation information." />
    <meta name="author" content="Unity Technologies" />
    <link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico" />
    <link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png" />
    <meta name="msapplication-TileColor" content="#222c37" />
    <meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png" />
    <script type="text/javascript" src="" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836">
    </script>
    <script type="text/javascript">
        function OptanonWrapper() { }
    </script>
    <script>
      var docs_type = 'ScriptReference';
      var lang = 'cn';
      var page = 'Profiling.Profiler-GetTotalFragmentationInfo';
      if(!page) page = 'index';
      var version = '2021.3';
      var docs_versions = [{version: '2022.1',version_string: '2022.1',supported: true},{version: '2021.3',version_string: '2021.3',supported: true},{version: '2021.2',version_string: '2021.2',supported: false},{version: '2021.1',version_string: '2021.1',supported: false},{version: '2020.3',version_string: '2020.3',supported: true},{version: '2020.2',version_string: '2020.2',supported: false},{version: '2020.1',version_string: '2020.1',supported: false},{version: '2019.4',version_string: '2019.4',supported: true},{version: '2019.3',version_string: '2019.3',supported: false},{version: '2019.2',version_string: '2019.2',supported: false},{version: '2019.1',version_string: '2019.1',supported: false},{version: '2018.4',version_string: '2018.4',supported: false},{version: '2018.3',version_string: '2018.3',supported: false},{version: '2018.2',version_string: '2018.2',supported: false},{version: '2018.1',version_string: '2018.1',supported: false},{version: '2017.4',version_string: '2017.4',supported: false},{version: '2017.3',version_string: '2017.3',supported: false},{version: '2017.2',version_string: '2017.2',supported: false},{version: '2017.1',version_string: '2017.1',supported: false},{version: '5.6',version_string: '560',supported: false},];</script>
    <script type="text/javascript" src="../StaticFiles/js/jquery.js">
    </script>
    <script type="text/javascript" src="../StaticFiles/js/core.js">
    </script>
    <script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js">
    </script>
    <script type="text/javascript" src="docdata/toc.js">
    </script>
    <script type="text/javascript" src="">
    </script>
    <script type="text/javascript" src="../StaticFiles/js/custom.js">
    </script>
    <link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css" />
    <link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css" />
    <link rel="canonical" href="https://docs.unity3d.com/cn/2021.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html" />
    <link rel="alternate" href="https://docs.unity3d.com/en/2021.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html" hreflang="en" />
    <link rel="alternate" href="https://docs.unity3d.com/cn/2021.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html" hreflang="zh" />
    <link rel="alternate" href="https://docs.unity3d.com/ja/2021.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html" hreflang="ja" />
    <link rel="alternate" href="https://docs.unity3d.com/es/2021.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html" hreflang="es" />
    <link rel="alternate" href="https://docs.unity3d.com/kr/2021.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html" hreflang="ko" />
    <link rel="alternate" href="https://docs.unity3d.com/ru/2021.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html" hreflang="ru" />
    <link rel="alternate" href="https://docs.unity3d.com/2021.3/Documentation/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html" hreflang="x-default" />
  </head>
  <body>
    <noscript>
      <iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden">
      </iframe>
    </noscript>
    <div class="header-wrapper">
      <div id="header" class="header">
        <div class="content">
          <div class="spacer">
            <div class="menu">
              <div id="nav-open" for="nav-input">
                <span>
                </span>
              </div>
              <div class="logo">
                <a href="./index.html">
                </a>
              </div>
              <div class="search-form">
                <form action="30_search.html" method="get" class="apisearch">
                  <input type="text" name="q" placeholder="搜索脚本..." autosave="Unity Reference" results="5" class="sbox field" id="q">
                  </input>
                  <input type="submit" class="submit">
                  </input>
                </form>
              </div>
              <ul class="menu-items">
                <li class="menu-item">
                  <a href="../Manual/index.html" class="">手册</a>
                </li>
                <li class="menu-item">
                  <a href="../ScriptReference/index.html" class="selected">脚本 API</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="more">
            <div class="filler">
            </div>
            <ul>
              <li>
                <a href="https://unity3d.com/">
                unity3d.com
              </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="toolbar">
        <div class="content">
          <div class="version-switcher">
            <div class="current toggle" data-target=".version-list">
              <div class="version-number">
                <div class="d-inline-block">
          Version:
          <b>2021.3</b></div>
                <div class="d-inline-block arrow">
                </div>
              </div>
            </div>
            <div class="version-list" style="display:none;">
              <ul class="versions">
                <li class="supported">
                  <a class="docs_version_url_2022.1" href="/cn/2022.1/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2022.1</a>
                </li>
                <li class="supported">
                  <a class="docs_version_url_2021.3" href="/cn/2021.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2021.3</a>
                </li>
                <li class="">
                  <a class="docs_version_url_2021.2" href="/cn/2021.2/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2021.2</a>
                </li>
                <li class="">
                  <a class="docs_version_url_2021.1" href="/cn/2021.1/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2021.1</a>
                </li>
                <li class="supported">
                  <a class="docs_version_url_2020.3" href="/cn/2020.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2020.3</a>
                </li>
                <li class="">
                  <a class="docs_version_url_2020.2" href="/cn/2020.2/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2020.2</a>
                </li>
                <li class="">
                  <a class="docs_version_url_2020.1" href="/cn/2020.1/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2020.1</a>
                </li>
                <li class="supported">
                  <a class="docs_version_url_2019.4" href="/cn/2019.4/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2019.4</a>
                </li>
                <li class="">
                  <a class="docs_version_url_2019.3" href="/cn/2019.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2019.3</a>
                </li>
                <li class="">
                  <a class="docs_version_url_2019.2" href="/cn/2019.2/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2019.2</a>
                </li>
                <li class="">
                  <a class="docs_version_url_2019.1" href="/cn/2019.1/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2019.1</a>
                </li>
                <li class="">
                  <a class="docs_version_url_2018.4" href="/cn/2018.4/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2018.4</a>
                </li>
                <li class="">
                  <a class="docs_version_url_2018.3" href="/cn/2018.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2018.3</a>
                </li>
                <li class="">
                  <a class="docs_version_url_2018.2" href="/cn/2018.2/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2018.2</a>
                </li>
                <li class="">
                  <a class="docs_version_url_2018.1" href="/cn/2018.1/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2018.1</a>
                </li>
                <li class="">
                  <a class="docs_version_url_2017.4" href="/cn/2017.4/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2017.4</a>
                </li>
                <li class="">
                  <a class="docs_version_url_2017.3" href="/cn/2017.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2017.3</a>
                </li>
                <li class="">
                  <a class="docs_version_url_2017.2" href="/cn/2017.2/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2017.2</a>
                </li>
                <li class="">
                  <a class="docs_version_url_2017.1" href="/cn/2017.1/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2017.1</a>
                </li>
                <li class="">
                  <a class="docs_version_url_560" href="/cn/560/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">5.6</a>
                </li>
                <div class="versionsWithThisPage" style="display:none;">
                  <li>
                    <p>包含此页的版本：</p>
                  </li>
                </div>
                <div class="versionsWithoutThisPage" style="display:none;">
                  <li>
                    <p>不含此页的版本：</p>
                  </li>
                </div>
              </ul>
              <ul class="description">
                <li>
                  <div class="supported-box">
                  </div>受支持</li>
                <li>
                  <div class="legacy-box">
                  </div>旧版</li>
              </ul>
            </div>
          </div>
          <ul class="nav-menu-items">
            <li class="menu-item">
              <a href="../Manual/index.html" class="">手册</a>
            </li>
            <li class="menu-item">
              <a href="../ScriptReference/index.html" class="selected">脚本 API</a>
            </li>
          </ul>
          <div class="lang-switcher">
            <div class="current toggle" data-target=".lang-list">
              <div class="lbl">语言:
        <span class="b">中文</span></div>
              <div class="arrow">
              </div>
            </div>
            <div class="lang-list" style="display:none;">
              <ul>
                <li>
                  <a data-lang="en" href="/2021.3/Documentation/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">English</a>
                </li>
                <li>
                  <a data-lang="cn" href="/cn/2021.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">中文</a>
                </li>
                <li>
                  <a data-lang="ja" href="/ja/2021.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">日本語</a>
                </li>
                <li>
                  <a data-lang="es" href="/es/2021.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">Español</a>
                </li>
                <li>
                  <a data-lang="kr" href="/kr/2021.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">한국어</a>
                </li>
                <li>
                  <a data-lang="ru" href="/ru/2021.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">Русский</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="master-wrapper" class="master-wrapper clear">
      <div id="sidebar" class="sidebar hidden">
        <div class="sidebar-wrap">
          <div class="content">
            <div class="sidebar-menu">
              <div class="toc">
                <h2>脚本 API</h2>
                <div class="version-switcher">
                  <div class="current toggle" data-target=".version-list">
                    <div class="version-number">
                      <div class="d-inline-block">
          Version:
          <b>2021.3</b></div>
                      <div class="d-inline-block arrow">
                      </div>
                    </div>
                  </div>
                  <div class="version-list" style="display:none;">
                    <ul class="versions">
                      <li class="supported">
                        <a class="docs_version_url_2022.1" href="/cn/2022.1/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2022.1</a>
                      </li>
                      <li class="supported">
                        <a class="docs_version_url_2021.3" href="/cn/2021.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2021.3</a>
                      </li>
                      <li class="">
                        <a class="docs_version_url_2021.2" href="/cn/2021.2/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2021.2</a>
                      </li>
                      <li class="">
                        <a class="docs_version_url_2021.1" href="/cn/2021.1/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2021.1</a>
                      </li>
                      <li class="supported">
                        <a class="docs_version_url_2020.3" href="/cn/2020.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2020.3</a>
                      </li>
                      <li class="">
                        <a class="docs_version_url_2020.2" href="/cn/2020.2/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2020.2</a>
                      </li>
                      <li class="">
                        <a class="docs_version_url_2020.1" href="/cn/2020.1/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2020.1</a>
                      </li>
                      <li class="supported">
                        <a class="docs_version_url_2019.4" href="/cn/2019.4/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2019.4</a>
                      </li>
                      <li class="">
                        <a class="docs_version_url_2019.3" href="/cn/2019.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2019.3</a>
                      </li>
                      <li class="">
                        <a class="docs_version_url_2019.2" href="/cn/2019.2/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2019.2</a>
                      </li>
                      <li class="">
                        <a class="docs_version_url_2019.1" href="/cn/2019.1/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2019.1</a>
                      </li>
                      <li class="">
                        <a class="docs_version_url_2018.4" href="/cn/2018.4/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2018.4</a>
                      </li>
                      <li class="">
                        <a class="docs_version_url_2018.3" href="/cn/2018.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2018.3</a>
                      </li>
                      <li class="">
                        <a class="docs_version_url_2018.2" href="/cn/2018.2/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2018.2</a>
                      </li>
                      <li class="">
                        <a class="docs_version_url_2018.1" href="/cn/2018.1/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2018.1</a>
                      </li>
                      <li class="">
                        <a class="docs_version_url_2017.4" href="/cn/2017.4/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2017.4</a>
                      </li>
                      <li class="">
                        <a class="docs_version_url_2017.3" href="/cn/2017.3/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2017.3</a>
                      </li>
                      <li class="">
                        <a class="docs_version_url_2017.2" href="/cn/2017.2/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2017.2</a>
                      </li>
                      <li class="">
                        <a class="docs_version_url_2017.1" href="/cn/2017.1/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">2017.1</a>
                      </li>
                      <li class="">
                        <a class="docs_version_url_560" href="/cn/560/ScriptReference/Profiling.Profiler-GetTotalFragmentationInfo.html">5.6</a>
                      </li>
                      <div class="versionsWithThisPage" style="display:none;">
                        <li>
                          <p>包含此页的版本：</p>
                        </li>
                      </div>
                      <div class="versionsWithoutThisPage" style="display:none;">
                        <li>
                          <p>不含此页的版本：</p>
                        </li>
                      </div>
                    </ul>
                    <ul class="description">
                      <li>
                        <div class="supported-box">
                        </div>受支持</li>
                      <li>
                        <div class="legacy-box">
                        </div>旧版</li>
                    </ul>
                  </div>
                </div>
                <div class="clear">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="content-wrap" class="content-wrap opened-sidebar">
        <div class="content-block">
          <div class="content">
            <div class="section">
              <div class="mb20 clear" id="">
                <h1 class="heading inherit">
                  <a href="Profiling.Profiler.html">Profiler</a>.GetTotalFragmentationInfo</h1>
                <div class="clear">
                </div>
                <div class="clear">
                </div>
                <a href="" class="switch-link gray-btn sbtn left hide">切换到手册</a>
                <div class="clear">
                </div>
              </div>
              <div class="subsection">
                <div class="signature">
                  <div class="signature-CS sig-block">
                    <span style="color:red;">
                    </span>public static long <span class="sig-kw">GetTotalFragmentationInfo</span>
        (NativeArray&lt;int&gt; <span class="sig-kw">stats</span>);
      </div>
                </div>
              </div>
              <div class="subsection">
                <h2>参数</h2>
                <table class="list">
                  <tr>
                    <td class="name lbl">stats</td>
                    <td class="desc">An array to receive the count of free blocks grouped by power of two sizes. Given a small array, Unity counts the larger free blocks together in the final array element.</td>
                  </tr>
                </table>
              </div>
              <div class="subsection">
                <h2>返回</h2>
                <p>
                  <strong>long</strong>
        Returns the total number of free blocks in the dynamic heap.
      </p>
              </div>
              <div class="subsection">
                <h2>描述</h2>
                <p>Returns heap memory fragmentation information.</p>
              </div>
              <div class="subsection">
                <p>
        Heap fragmentation is a measure of how much space is potentially unusable in the dynamic heap. If your application has too much heap fragmentation it can lead to memory allocation failures.<br /><br />There might be more total free memory than your application needs for an allocation, but because this free memory is composed of two or more separate smaller memory blocks, then the allocation might fail.<br /><br />Some memory usage patterns at runtime can cause the number of free blocks to grow over time, which results in fragmentation of the heap.<br /><br />As an example, consider when Unity frees a large allocation, a single large free block is returned to the heap. This large free block could then later be used to satisfy many more smaller allocations if no smaller blocks are available.<br /><br />If all these small allocations other than a single allocation in the middle of this block are freed, then the heap now has two smaller free blocks either side of the single remaining allocation. A new allocation of the original large size might fail if there are no larger blocks available to use.<br /><br />As Unity dynamically allocates and frees memory, it manages the heap area by keeping track of free memory blocks. Internally, Unity groups these free memory blocks into lists of similar sizes - grouped in power of two sizes, between one power of two and the next, specifically [ (2^n) .. (2^(n+1) - 1) ].<br /><br />  e.g. blocks of sizes [1], [2..3], [4..7], [8..15], [16..31], [32..63], [64..127], [128..256] ... bytes.<br /><br />This design gives quick and constant time allocator performance for all allocations regardless of allocation size or heap capacity.<br /><br />You can use <a href="Profiling.Profiler.GetTotalFragmentationInfo.html">Profiler.GetTotalFragmentationInfo</a> to keep track of the heap's free memory blocks over time.
      </p>
              </div>
              <div class="subsection">
        <pre class="codeExampleCS">
using Unity.Collections;
using UnityEngine;
using UnityEngine.Profiling;<br /><br />public class Example : <a href="MonoBehaviour.html">MonoBehaviour</a>
{
    const int kFreeBlockPow2Buckets = 24;<br /><br />    void <a href="PlayerLoop.Update.html">Update</a>()
    {
        var freeStats = new NativeArray&lt;int&gt;(kFreeBlockPow2Buckets, <a href="Unity.Collections.Allocator.Temp.html">Allocator.Temp</a>);
        var freeBlocks = <a href="Profiling.Profiler.GetTotalFragmentationInfo.html">Profiler.GetTotalFragmentationInfo</a>(freeStats);<br /><br />        <a href="Debug.Log.html">Debug.Log</a>(string.Format("Total Free Blocks: {0}", freeBlocks));
        for (int i = 0; i &lt; kFreeBlockPow2Buckets; i++)
        {
            <a href="Debug.Log.html">Debug.Log</a>(string.Format(" size[2^{0}] = {1} blocks", i, freeStats[i]));
        }
    }
}
</pre>
      </div>
            </div>
            <div class="footer-wrapper">
              <div class="footer clear">
                <div class="copy">Copyright © 2022 Unity Technologies. Publication 2021.3</div>
                <div class="menu">
                  <a href="https://learn.unity.com/">教程</a>
                  <a href="https://answers.unity3d.com">社区答案</a>
                  <a href="https://support.unity3d.com/hc/en-us">知识库</a>
                  <a href="https://forum.unity3d.com">论坛</a>
                  <a href="https://unity3d.com/asset-store">Asset Store</a>
                </div>
              </div>
              <div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>