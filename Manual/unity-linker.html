<!DOCTYPE html><html class="no-js" lang="zh-cn">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script><link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta property="og:title" content="The Unity linker - Unity 手册">
<title>The Unity linker - Unity 手册</title>
<meta property="og:image" content="https://unity3d.com/files/images/ogimg.jpg">
<meta name="description" content="The Unity build process uses a tool called the Unity linker to strip managed code. The Unity linker is a version of the IL Linker customized to work with Unity. The custom Unity Engine specific parts of the Unity linker aren’t publicly available.">
<meta property="og:description" content="The Unity build process uses a tool called the Unity linker to strip managed code. The Unity linker is a version of the IL Linker customized to work with Unity. The custom Unity Engine specific parts of the Unity linker aren’t publicly available.">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836"></script><script type="text/javascript">
        function OptanonWrapper() { }
    </script><script>
      var docs_type = 'Manual';
      var lang = 'cn';
      var page = 'unity-linker';
      if(!page) page = 'index';
      var version = '2021.3';
      var docs_versions = [{version: '2022.1',version_string: '2022.1',supported: true},{version: '2021.3',version_string: '2021.3',supported: true},{version: '2021.2',version_string: '2021.2',supported: false},{version: '2021.1',version_string: '2021.1',supported: false},{version: '2020.3',version_string: '2020.3',supported: true},{version: '2020.2',version_string: '2020.2',supported: false},{version: '2020.1',version_string: '2020.1',supported: false},{version: '2019.4',version_string: '2019.4',supported: true},{version: '2019.3',version_string: '2019.3',supported: false},{version: '2019.2',version_string: '2019.2',supported: false},{version: '2019.1',version_string: '2019.1',supported: false},{version: '2018.4',version_string: '2018.4',supported: false},{version: '2018.3',version_string: '2018.3',supported: false},{version: '2018.2',version_string: '2018.2',supported: false},{version: '2018.1',version_string: '2018.1',supported: false},{version: '2017.4',version_string: '2017.4',supported: false},{version: '2017.3',version_string: '2017.3',supported: false},{version: '2017.2',version_string: '2017.2',supported: false},{version: '2017.1',version_string: '2017.1',supported: false},{version: '5.6',version_string: '560',supported: false},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
<link rel="canonical" href="https://docs.unity3d.com/cn/2021.3/Manual/unity-linker.html">
<link rel="alternate" href="https://docs.unity3d.com/en/2021.3/Manual/unity-linker.html" hreflang="en">
<link rel="alternate" href="https://docs.unity3d.com/cn/2021.3/Manual/unity-linker.html" hreflang="zh">
<link rel="alternate" href="https://docs.unity3d.com/ja/2021.3/Manual/unity-linker.html" hreflang="ja">
<link rel="alternate" href="https://docs.unity3d.com/es/2021.3/Manual/unity-linker.html" hreflang="es">
<link rel="alternate" href="https://docs.unity3d.com/kr/2021.3/Manual/unity-linker.html" hreflang="ko">
<link rel="alternate" href="https://docs.unity3d.com/ru/2021.3/Manual/unity-linker.html" hreflang="ru">
<link rel="alternate" href="https://docs.unity3d.com/2021.3/Documentation/Manual/unity-linker.html" hreflang="x-default">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="./index.html"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="搜索手册..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2021.3</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2022.1" href="/cn/2022.1/Manual/unity-linker.html">2022.1</a></li>
<li class="supported"><a class="docs_version_url_2021.3" href="/cn/2021.3/Manual/unity-linker.html">2021.3</a></li>
<li class=""><a class="docs_version_url_2021.2" href="/cn/2021.2/Manual/unity-linker.html">2021.2</a></li>
<li class=""><a class="docs_version_url_2021.1" href="/cn/2021.1/Manual/unity-linker.html">2021.1</a></li>
<li class="supported"><a class="docs_version_url_2020.3" href="/cn/2020.3/Manual/unity-linker.html">2020.3</a></li>
<li class=""><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/unity-linker.html">2020.2</a></li>
<li class=""><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/unity-linker.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/unity-linker.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/unity-linker.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/unity-linker.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/unity-linker.html">2019.1</a></li>
<li class=""><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/unity-linker.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/unity-linker.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/unity-linker.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/unity-linker.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/unity-linker.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/unity-linker.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/unity-linker.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/unity-linker.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/unity-linker.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">语言:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/2021.3/Documentation/Manual/unity-linker.html">English</a></li>
<li><a data-lang="cn" href="/cn/2021.3/Manual/unity-linker.html">中文</a></li>
<li><a data-lang="ja" href="/ja/2021.3/Manual/unity-linker.html">日本語</a></li>
<li><a data-lang="es" href="/es/2021.3/Manual/unity-linker.html">Español</a></li>
<li><a data-lang="kr" href="/kr/2021.3/Manual/unity-linker.html">한국어</a></li>
<li><a data-lang="ru" href="/ru/2021.3/Manual/unity-linker.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>手册</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2021.3</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2022.1" href="/cn/2022.1/Manual/unity-linker.html">2022.1</a></li>
<li class="supported"><a class="docs_version_url_2021.3" href="/cn/2021.3/Manual/unity-linker.html">2021.3</a></li>
<li class=""><a class="docs_version_url_2021.2" href="/cn/2021.2/Manual/unity-linker.html">2021.2</a></li>
<li class=""><a class="docs_version_url_2021.1" href="/cn/2021.1/Manual/unity-linker.html">2021.1</a></li>
<li class="supported"><a class="docs_version_url_2020.3" href="/cn/2020.3/Manual/unity-linker.html">2020.3</a></li>
<li class=""><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/unity-linker.html">2020.2</a></li>
<li class=""><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/unity-linker.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/unity-linker.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/unity-linker.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/unity-linker.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/unity-linker.html">2019.1</a></li>
<li class=""><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/unity-linker.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/unity-linker.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/unity-linker.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/unity-linker.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/unity-linker.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/unity-linker.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/unity-linker.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/unity-linker.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/unity-linker.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual 2021.3 (LTS)</a></li>
<li><a href="ScriptingSection.html">脚本</a></li>
<li><a href="unity-architecture.html">Unity 架构</a></li>
<li><a href="scripting-backends.html">脚本后端</a></li>
<li>The Unity linker</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="ManagedCodeStripping.html"></a></span><div class="tip">托管代码剥离</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="code-reloading-editor.html"></a></span><div class="tip">在 Unity 编辑器中重新加载代码</div>
</div>
</div></div>
<h1>The Unity linker</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>The Unity build process uses a tool called the Unity linker to strip managed code. The Unity linker is a version of the <a href="https://github.com/mono/linker">IL Linker</a> customized to work with Unity. The custom Unity Engine specific parts of the Unity linker aren’t publicly available.</p>

<p>The Unity linker is responsible for both managed code stripping and part of the process of engine code stripping, which is a separate process available through the IL2CPP script backend that removes unused engine code. For more information, see <a href="../ScriptReference/PlayerSettings-stripEngineCode.html">PlayerSettings.StripEngineCode</a>].</p>

<h2>How the Unity linker works</h2>

<p>The Unity linker analyzes all the assemblies in your project. First, it marks root types, methods, properties, and fields. For example, MonoBehaviour-derived classes you add to GameObjects in a Scene are root types. 

The Unity linker then analyzes the roots it has marked to identify, and marks any managed code that these roots depend upon. Upon completion of this static analysis, any remaining unmarked code is unreachable by any execution path through your application code and the Unity linker deletes it from the assembly.</p>

<h2>How the Unity linker strips assemblies</h2>

<p>The Unity Editor creates a list of the assemblies that contain types used in any of the Scenes in your Unity project and passes this list to the Unity linker. The Unity linker then processes those assemblies, any references of those assemblies, any assemblies declared in a link.xml file, and any assemblies with the AlwaysLinkAssembly attribute. In general, the Unity linker doesn’t process assemblies included in your project that don’t fall under one of these categories, and excludes them from the Player build.</p>

<p>For each assembly the Unity linker processes, it follows a set of rules based on the classification of the assembly, whether the assembly contains types used in a Scene, and the <strong>Managed Stripping Level</strong> you have selected for the build.</p>

<p>根据这些规则的用途，程序集划为以下几种分类：</p>

<ul>
<li>.NET Class Library assemblies — Includes the Mono class libraries such as mscorlib.dll and System.dll, as well as .NET class library facade assemblies like netstandard.dll.</li>
<li>Platform SDK assemblies — Includes the managed assemblies specific to a platform SDK. For example, the windows.winmd assembly that is part of the Universal Windows Platform SDK.</li>
<li>Unity Engine Module assemblies — Includes the managed assemblies that make up the Unity Engine, such as UnityEngine.Core.dll.</li>
<li>Project assemblies — Includes the assemblies specific to a project such as:

<ul>
<li>脚本程序集，如 Assembly-CSharp.dll</li>
<li>预编译的程序集</li>
<li><a href="https://docs.unity3d.com/Manual/ScriptCompilationAssemblyDefinitionFiles.html">Assembly Definition Assemblies</a></li>
<li>软件包程序集</li>
</ul>
</li>
</ul>

<h2>Marking rules</h2>

<p>When you build a project in Unity, the build process compiles your C# code to a .NET bytecode format called Common Intermediate Language (CIL). Unity packages this CIL byte code into files called assemblies. The .NET framework libraries and any C# libraries in the plugins you use in your project are also pre-packaged as assemblies of CIL bytecode.</p>

<p>When the Unity linker performs its static analysis, it follows sets of rules to determine which parts of the CIL bytecode the Unity linker marks as necessary for the build. Root marking rules determine how the Unity linker identifies and preserves top-level assemblies in the build. Dependency marking rules determine how the Unity linker identifies and preserves any code that the root assemblies depend on.</p>

<p>The <strong>Managed Stripping Level</strong> property changes the set of rules that the Unity linker uses. The following sections describe the marking rules for each possible setting for the <strong>Managed Stripping Level</strong> property.</p>

<h3>Root marking rules</h3>

<p>The following table describes how the Unity linker identifies the top-level types in an assembly:</p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
<col style="text-align:left;">
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;" colspan="4"><strong>Assembly type:</strong></th>
	<th style="text-align:left;"><strong>Marking rules:</strong></th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"></td>
	<td style="text-align:left;"><strong>Minimal</strong></td>
	<td style="text-align:left;"><strong>Low</strong></td>
	<td style="text-align:left;"><strong>Medium</strong></td>
	<td style="text-align:left;"><strong>High</strong></td>
</tr>
<tr>
	<td style="text-align:left;"><strong>.NET Class &amp; Platform SDK and UnityEngine Assemblies</strong></td>
	<td style="text-align:left;">Applies precautionary preservations and any preservations defined in any link.xml file.</td>
	<td style="text-align:left;">Applies precautionary preservations and any preservations defined in any link.xml file.</td>
	<td style="text-align:left;">Applies any preservations defined in any link.xml file.</td>
	<td style="text-align:left;">Applies any preservations defined in any link.xml file.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Assemblies with types referenced in a scene</strong></td>
	<td style="text-align:left;">Marks all types and members in the assembly.</td>
	<td style="text-align:left;">Marks all types and members in the assembly.</td>
	<td style="text-align:left;">Marks the following:<br>•All methods which have the <code>[RuntimeInitializeOnLoadMethod]</code> or <code>[Preserve]</code> attribute.<br>•Preservations defined in any link.xml file.<br>•Marks all types derived from MonoBehaviour and ScriptableObject in precompiled, package, Unity Script or assembly definition assemblies.</td>
	<td style="text-align:left;">Marks the following:<br>•All methods which have the <code>[RuntimeInitializeOnLoadMethod]</code> or <code>[Preserve]</code> attribute.<br>•Preservations defined in any link.xml file.<br>•Marks all types derived from MonoBehaviour and ScriptableObject in precompiled, package, Unity Script or assembly definition assemblies.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>All other</strong></td>
	<td style="text-align:left;">Marks all types and members in the assembly.</td>
	<td style="text-align:left;">Marks the following:<br>•All public types and public members of those types.<br>•All methods which have the <code>[RuntimeInitializeOnLoadMethod]</code> or <code>[Preserve]</code> attribute.<br>•Preservations defined in any link.xml file.<br>•All types derived from MonoBehaviour and ScriptableObject in precompiled, package, Unity Script or assembly definition assemblies.</td>
	<td style="text-align:left;">Marks the following:<br>•All public types and public members of those types.<br>•All methods which have the <code>[RuntimeInitializeOnLoadMethod]</code> or <code>[Preserve]</code> attribute.<br>•Preservations defined in any link.xml file.<br>•All types derived from MonoBehaviour and ScriptableObject in precompiled, package, Unity Script or assembly definition assemblies.</td>
	<td style="text-align:left;">Marks the following:<br>•All methods which have the <code>[RuntimeInitializeOnLoadMethod]</code> or <code>[Preserve]</code> attribute.<br>•Preservations defined in any link.xml file.<br>•All types derived from MonoBehaviour and ScriptableObject in precompiled, package, Unity Script or assembly definition assemblies.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Test</strong></td>
	<td style="text-align:left;" colspan="5">Marks any methods with the <code>[UnityTest]</code> attribute and any methods annotated with an Attribute defined in the NUnit.Framework.</td>
</tr>
</tbody>
</table>

<h3>Dependency marking rules</h3>

<p>After the Unity linker identifies the roots in an assembly, it needs to identify any code that those roots depend on. The following table describes how the Unity linker identifies dependencies of root types in an assembly:</p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
<col style="text-align:left;">
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;" colspan="4"><strong>Rule Target</strong></th>
	<th style="text-align:left;"><strong>Action at each stripping level</strong></th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"></td>
	<td style="text-align:left;"><strong>Minimal</strong></td>
	<td style="text-align:left;"><strong>Low</strong></td>
	<td style="text-align:left;"><strong>Medium</strong></td>
	<td style="text-align:left;"><strong>High</strong></td>
</tr>
<tr>
	<td style="text-align:left;"><strong>MonoBehaviour</strong></td>
	<td style="text-align:left;" colspan="4">The Unity linker marks all members of a MonoBehavior type when it marks the type.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>ScriptableObject</strong></td>
	<td style="text-align:left;" colspan="4">The Unity linker marks all members of a ScriptableObject type when it marks the type.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Attributes</strong></td>
	<td style="text-align:left;">When the Unity linker marks an assembly, type or other code structure, it also marks all attributes of those structures.</td>
	<td style="text-align:left;">When the Unity linker marks an assembly, type or other code structure, it also marks all attributes of those structures.</td>
	<td style="text-align:left;">When the Unity linker marks an assembly, type or other code structure, it only marks attributes of those structures if the attribute type is also marked.</td>
	<td style="text-align:left;">When the Unity linker marks an assembly, type or other code structure, it only marks attributes of those structures if the attribute type is also marked.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Debugging Attributes</strong></td>
	<td style="text-align:left;">When script debugging is enabled, the Unity linker marks all members that have the <code>[DebuggerDisplay]</code> attribute, even when there isn’t a code path that uses those members.</td>
	<td style="text-align:left;">When script debugging is enabled, the Unity linker marks all members that have the <code>[DebuggerDisplay]</code> attribute, even when there isn’t a code path that uses those members.</td>
	<td style="text-align:left;">The Unity linker always removes debugging attributes such as DebuggerDisplayAttribute and DebuggerTypeProxyAttribute.</td>
	<td style="text-align:left;">The Unity linker always removes debugging attributes such as DebuggerDisplayAttribute and DebuggerTypeProxyAttribute.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>.NET Facade Class Library</strong></td>
	<td style="text-align:left;" colspan="5">Removes facade assemblies since they aren’t necessary at runtime.</td>
</tr>
</tbody>
</table>

<h2>Link XML feature tag exclusions</h2>

<p><a href="https://docs.unity3d.com/Manual/ManagedCodeStripping.html#LinkXML">Link.xml</a> files support an uncommonly used “features” XML attribute. In the example, the mscorlib.xml file embedded in mscorlib.dll uses this attribute, but you can use it in any link.xml file, when appropriate.</p>

<p>When you use the <strong>High</strong> stripping level, the Unity linker excludes preservations for features that aren’t supported based on the settings for the current build:</p>

<ol>
<li>remoting — Excluded when targeting the IL2CPP scripting backend.</li>
<li>sre — Excluded when targeting the IL2CPP scripting backend.</li>
<li>com — Excluded when targeting platforms that don’t support COM.</li>
</ol>

<p>例如，下面的 link.xml 文件在支持 COM 的平台上保留某种类型的一个方法，并在所有平台上保留一个方法：</p>

<pre><code class="xml-doc">&lt;linker&gt;

    &amp;lt;assembly fullname="Foo"&gt;

        &amp;lt;type fullname="Type1"&gt;

            &amp;lt;!--Preserve FeatureOne on platforms that support COM--&gt;

            &amp;lt;method signature="System.Void FeatureOne()" feature="com"/&gt;

            &amp;lt;!--Preserve FeatureTwo on all platforms--&gt;

            &amp;lt;method signature="System.Void FeatureTwo()"/&gt;

        &amp;lt;/type&gt;

    &amp;lt;/assembly&gt;

&lt;/linker&gt;
</code></pre>

<h2>Editing of method bodies</h2>

<p>When you use the <strong>High</strong> stripping level, the Unity linker edits method bodies to further reduce code size. This section summarizes some of the notable edits that the Unity linker makes to method bodies.</p>

<p>The Unity linker only edits method bodies in the .NET Class Library assemblies. After method body editing, the source code of the assembly no longer matches the compiled code in the assembly, which can make debugging more difficult.</p>

<p>The following list describes actions that the Unity linker can perform to edit a method body:</p>

<ul>
<li>Remove unreachable branches - The Unity linker removes If-statement blocks that check System.Environment.OSVersion.Platform and aren’t reachable for the currently targeted platform.</li>
<li>Inline methods that only access fields - The Unity linker replaces calls to methods that get or set a field with direct access to the field. This often makes it possible to strip away the method entirely. When you use the Mono backend, the Unity linker only makes this change when the caller of the method is allowed to directly access the field, based on the field’s visibility. For IL2CPP, visibility rules don’t apply, so the Unity linker makes this change where appropriate.</li>
<li>Inline methods that return a const value - The Unity linker inlines calls to methods that only return a const value.</li>
<li>Remove empty non-returning calls - The Unity linker removes calls to methods that are empty and have a void return type.</li>
<li>Remove empty scope - The Unity linker removes Try/Finally blocks when the Finally block is empty. Removing <a href="https://docs.unity3d.com/Manual/ManagedCodeStripping.html#EmptyCalls">empty calls</a> can create empty Finally blocks. When that happens during method editing, Unity linker removes the entire Try/Finally block. One scenario where this can occur is when the compiler generates Try/Finally blocks as part of foreach loops in order to call Dispose().</li>
</ul>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="ManagedCodeStripping.html"></a></span><div class="tip">托管代码剥离</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="code-reloading-editor.html"></a></span><div class="tip">在 Unity 编辑器中重新加载代码</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">Copyright © 2022 Unity Technologies. Publication 2021.3</div>
<div class="menu">
<a href="https://learn.unity.com/">教程</a><a href="https://answers.unity3d.com">社区答案</a><a href="https://support.unity3d.com/hc/en-us">知识库</a><a href="https://forum.unity3d.com">论坛</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
