<!DOCTYPE html><html class="no-js" lang="zh-cn">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script><link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta property="og:title" content="Custom scripting symbols - Unity 手册">
<title>Custom scripting symbols - Unity 手册</title>
<meta property="og:image" content="https://docs.unity3d.com/cn/2021.3/uploads/Main/ScriptDefines.png">
<meta name="description" content="C# directives allow you to selectively include or exclude code from compilation, based on whether certain scripting symbols are defined or not defined.">
<meta property="og:description" content="C# directives allow you to selectively include or exclude code from compilation, based on whether certain scripting symbols are defined or not defined.">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836"></script><script type="text/javascript">
        function OptanonWrapper() { }
    </script><script>
      var docs_type = 'Manual';
      var lang = 'cn';
      var page = 'CustomScriptingSymbols';
      if(!page) page = 'index';
      var version = '2021.3';
      var docs_versions = [{version: '2022.1',version_string: '2022.1',supported: true},{version: '2021.3',version_string: '2021.3',supported: true},{version: '2021.2',version_string: '2021.2',supported: false},{version: '2021.1',version_string: '2021.1',supported: false},{version: '2020.3',version_string: '2020.3',supported: true},{version: '2020.2',version_string: '2020.2',supported: false},{version: '2020.1',version_string: '2020.1',supported: false},{version: '2019.4',version_string: '2019.4',supported: true},{version: '2019.3',version_string: '2019.3',supported: false},{version: '2019.2',version_string: '2019.2',supported: false},{version: '2019.1',version_string: '2019.1',supported: false},{version: '2018.4',version_string: '2018.4',supported: false},{version: '2018.3',version_string: '2018.3',supported: false},{version: '2018.2',version_string: '2018.2',supported: false},{version: '2018.1',version_string: '2018.1',supported: false},{version: '2017.4',version_string: '2017.4',supported: false},{version: '2017.3',version_string: '2017.3',supported: false},{version: '2017.2',version_string: '2017.2',supported: false},{version: '2017.1',version_string: '2017.1',supported: false},{version: '5.6',version_string: '560',supported: false},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
<link rel="canonical" href="https://docs.unity3d.com/cn/2021.3/Manual/CustomScriptingSymbols.html">
<link rel="alternate" href="https://docs.unity3d.com/en/2021.3/Manual/CustomScriptingSymbols.html" hreflang="en">
<link rel="alternate" href="https://docs.unity3d.com/cn/2021.3/Manual/CustomScriptingSymbols.html" hreflang="zh">
<link rel="alternate" href="https://docs.unity3d.com/ja/2021.3/Manual/CustomScriptingSymbols.html" hreflang="ja">
<link rel="alternate" href="https://docs.unity3d.com/es/2021.3/Manual/CustomScriptingSymbols.html" hreflang="es">
<link rel="alternate" href="https://docs.unity3d.com/kr/2021.3/Manual/CustomScriptingSymbols.html" hreflang="ko">
<link rel="alternate" href="https://docs.unity3d.com/ru/2021.3/Manual/CustomScriptingSymbols.html" hreflang="ru">
<link rel="alternate" href="https://docs.unity3d.com/2021.3/Documentation/Manual/CustomScriptingSymbols.html" hreflang="x-default">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="./index.html"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="搜索手册..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2021.3</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2022.1" href="/cn/2022.1/Manual/CustomScriptingSymbols.html">2022.1</a></li>
<li class="supported"><a class="docs_version_url_2021.3" href="/cn/2021.3/Manual/CustomScriptingSymbols.html">2021.3</a></li>
<li class=""><a class="docs_version_url_2021.2" href="/cn/2021.2/Manual/CustomScriptingSymbols.html">2021.2</a></li>
<li class=""><a class="docs_version_url_2021.1" href="/cn/2021.1/Manual/CustomScriptingSymbols.html">2021.1</a></li>
<li class="supported"><a class="docs_version_url_2020.3" href="/cn/2020.3/Manual/CustomScriptingSymbols.html">2020.3</a></li>
<li class=""><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/CustomScriptingSymbols.html">2020.2</a></li>
<li class=""><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/CustomScriptingSymbols.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/CustomScriptingSymbols.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/CustomScriptingSymbols.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/CustomScriptingSymbols.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/CustomScriptingSymbols.html">2019.1</a></li>
<li class=""><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/CustomScriptingSymbols.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/CustomScriptingSymbols.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/CustomScriptingSymbols.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/CustomScriptingSymbols.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/CustomScriptingSymbols.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/CustomScriptingSymbols.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/CustomScriptingSymbols.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/CustomScriptingSymbols.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/CustomScriptingSymbols.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">语言:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/2021.3/Documentation/Manual/CustomScriptingSymbols.html">English</a></li>
<li><a data-lang="cn" href="/cn/2021.3/Manual/CustomScriptingSymbols.html">中文</a></li>
<li><a data-lang="ja" href="/ja/2021.3/Manual/CustomScriptingSymbols.html">日本語</a></li>
<li><a data-lang="es" href="/es/2021.3/Manual/CustomScriptingSymbols.html">Español</a></li>
<li><a data-lang="kr" href="/kr/2021.3/Manual/CustomScriptingSymbols.html">한국어</a></li>
<li><a data-lang="ru" href="/ru/2021.3/Manual/CustomScriptingSymbols.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>手册</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2021.3</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2022.1" href="/cn/2022.1/Manual/CustomScriptingSymbols.html">2022.1</a></li>
<li class="supported"><a class="docs_version_url_2021.3" href="/cn/2021.3/Manual/CustomScriptingSymbols.html">2021.3</a></li>
<li class=""><a class="docs_version_url_2021.2" href="/cn/2021.2/Manual/CustomScriptingSymbols.html">2021.2</a></li>
<li class=""><a class="docs_version_url_2021.1" href="/cn/2021.1/Manual/CustomScriptingSymbols.html">2021.1</a></li>
<li class="supported"><a class="docs_version_url_2020.3" href="/cn/2020.3/Manual/CustomScriptingSymbols.html">2020.3</a></li>
<li class=""><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/CustomScriptingSymbols.html">2020.2</a></li>
<li class=""><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/CustomScriptingSymbols.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/CustomScriptingSymbols.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/CustomScriptingSymbols.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/CustomScriptingSymbols.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/CustomScriptingSymbols.html">2019.1</a></li>
<li class=""><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/CustomScriptingSymbols.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/CustomScriptingSymbols.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/CustomScriptingSymbols.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/CustomScriptingSymbols.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/CustomScriptingSymbols.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/CustomScriptingSymbols.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/CustomScriptingSymbols.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/CustomScriptingSymbols.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/CustomScriptingSymbols.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual 2021.3 (LTS)</a></li>
<li><a href="ScriptingSection.html">脚本</a></li>
<li><a href="unity-architecture.html">Unity 架构</a></li>
<li><a href="script-compilation.html">脚本编译</a></li>
<li><a href="PlatformDependentCompilation.html">Conditional Compilation</a></li>
<li>Custom scripting symbols</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="PlatformDependentCompilation.html"></a></span><div class="tip">Conditional Compilation</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="ScriptCompilationAssemblyDefinitionFiles.html"></a></span><div class="tip">程序集定义</div>
</div>
</div></div>
<h1>Custom scripting symbols</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p><strong>C# directives</strong> allow you to <a href="PlatformDependentCompilation.html">selectively include or exclude code from compilation</a>, based on whether certain <strong>scripting symbols</strong> are <em>defined</em> or <em>not defined</em>.</p>

<p>In addition to the built-in scripting symbols (relating to <a href="PlatformDependentCompilation.html#Platform">Platform</a>, the <a href="PlatformDependentCompilation.html#Editor">Editor Version</a>, and <a href="PlatformDependentCompilation.html#Other">other</a> miscellaneous system environment scenarios), you can specify your own custom scripting symbols, either using the Editor UI, via scripting, or via an asset file.</p>

<h2>Setting scripting symbols via the Editor</h2>

<p>To set or remove define directives via the Editor, go to <strong>Edit</strong> &gt; <strong>Project Settings</strong> &gt; <strong>Player</strong>. Then in the <strong>Other Settings</strong> panel, scroll down to <strong>Script Compilation</strong>.</p>

<figure>
<img src="../uploads/Main/ScriptDefines.png" alt="The Scripting Define Symbols settings in the Project Settings window. This example shows two custom symbols defined in the list.">
<figcaption>The Scripting Define Symbols settings in the Project Settings window. This example shows two custom symbols defined in the list.</figcaption>
</figure>

<p>You can add and remove your own custom scripting symbols to the <strong>Scripting Define Symbols</strong> list by using the <strong>+</strong> and <strong>-</strong> buttons, and typing the name of your new symbols into the fields. When you select <strong>Apply</strong>, your new scripting symbols are applied, and Unity recompiles the scripts in your project using these new symbols.</p>

<p>The <strong>Copy Defines</strong> button copies the current set of custom scripting symbols from the list into your clipboard as a string of semicolon-separated values.</p>

<h2>Defining scripting symbols via script</h2>

<p>You can use the following API to define scripting symbols:</p>

<ul>
<li><a href="../ScriptReference/PlayerSettings.SetScriptingDefineSymbolsForGroup.html">PlayerSettings.SetScriptingDefineSymbolsForGroup</a></li>
<li><a href="../ScriptReference/Build.Player.ScriptCompilationSettings-extraScriptingDefines.html">BuildPlayerOptions.extraScriptingDefines</a></li>
<li><a href="../ScriptReference/Build.Player.ScriptCompilationSettings-extraScriptingDefines.html">Build.Player.ScriptCompilationSettings-extraScriptingDefines</a></li>
</ul>

<h3>Setting scripting symbols for Editor script compilation</h3>

<p>If you need to define scripting symbols via scripts in the Editor so that your Editor scripts are affected by the change, you must use <a href="../ScriptReference/PlayerSettings.SetScriptingDefineSymbolsForGroup.html">PlayerSettings.SetScriptingDefineSymbolsForGroup</a>. However, there are some important details to note about how this operates.</p>

<p><strong>Important:</strong> this method does not take immediate effect. Calling this method from script does not immediately apply and recompile your scripts. For your directives to take effect based on a change in scripting symbols, you must allow control to be returned to the Editor, where it then asynchronously reloads the scripts and recompiles them based on your new symbols and the directives which act on them.</p>

<p>So, for example, if you use this method in an Editor script, then immediately call <code>BuildPipeline.BuildPlayer</code> on the following line in the same script, at that point Unity is still running your Editor scripts with the old set of scripting symbols, because they have not yet been recompiled with the new symbols. This means if you have Editor scripts which run as part of your BuildPlayer execution, they run with the old scripting symbols and your player might not build as you expected.</p>

<h3>Setting scripting symbols in batch mode</h3>

<p>The asynchronous nature of Unity’s compilation mentioned above is also important to understand if you are writing Editor scripts which will run in batch mode in the Unity Editor on a continuous integration (CI) server. This is because when the Editor runs in batch mode, it runs “<a href="https://en.wikipedia.org/wiki/Headless_software">headless</a>”, so there is no <strong>editor loop</strong> which would cause it to recompile with the new scripting symbols. Because of this, you should not use Editor scripts to set scripting symbols within a batch mode CI server because the scripts will not be recompiled, so they will not be applied.</p>

<p>Instead, if you need specific symbols to be defined in an Editor running in batch mode, you must ensure the editor is launched with the correct symbols defined from the start. You can do this by specifying the symbols using a csc.rsp asset file instead of using editor scripts, as described below.</p>

<h2>Setting scripting symbols via an asset file</h2>

<p>You can set custom scripting symbols via a text asset in your project. To do this you must add a text file that defines the custom scripting symbols named <code>csc.rsp</code> in the root of your project’s <strong>Assets</strong> folder. This special file is read by Unity at startup and applied before any code is compiled. </p>

<p>As an example, if you include the single line -define:UNITY_DEBUG in your <strong>csc.rsp</strong> file, the symbol UNITY_DEBUG is included as a globally defined scripting symbol for C# scripts, except for Editor scripts.</p>

<p>Every time you make changes to <strong>.rsp</strong> files, you need to recompile in order for them to be effective. You can do this by updating or reimporting a single script file.</p>

<p><strong>Note:</strong> If you want to modify only global scripting symbols, add them to the <strong>Scripting Define Symbols</strong> in the Editor via the Player Settings window (as described above), because this covers all the compilers. If you choose the <strong>.rsp</strong> files instead, you need to provide one file for every compiler Unity uses.</p>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="PlatformDependentCompilation.html"></a></span><div class="tip">Conditional Compilation</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="ScriptCompilationAssemblyDefinitionFiles.html"></a></span><div class="tip">程序集定义</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">Copyright © 2022 Unity Technologies. Publication 2021.3</div>
<div class="menu">
<a href="https://learn.unity.com/">教程</a><a href="https://answers.unity3d.com">社区答案</a><a href="https://support.unity3d.com/hc/en-us">知识库</a><a href="https://forum.unity3d.com">论坛</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
